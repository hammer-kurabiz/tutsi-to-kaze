{%- style -%}
    #shopify-section-{{ section.id }} {
        --section-background-color: {{ section.settings.background_color }};
        --section-padding-top-desktop: {{ section.settings.padding_top }}px;
        --section-padding-bottom-desktop: {{ section.settings.padding_bottom }}px;
        --section-padding-top-mobile: {{ section.settings.padding_top | times: 0.7 | round }}px;
        --section-padding-bottom-mobile: {{ section.settings.padding_bottom | times: 0.7 | round }}px;
    }
{%- endstyle -%}

<div class="custom-search-wrapper" style="background-color: var(--section-background-color);">
    <div class="custom-search page-width">
        {%- render 'section-title',
            heading: section.settings.heading,
            subheading: section.settings.subheading,
            text_alignment: section.settings.title_text_alignment,
            padding_top: section.settings.title_padding_top,
            padding_bottom: section.settings.title_padding_bottom,
            subheading_color: section.settings.title_subheading_color
        -%}

        <div class="custom-search__main">
            <div class="custom-search__group">
                <h3 class="custom-search__group-title">シーンを選ぶ</h3>
                <div class="custom-search__scene-grid">
                    {%- for block in section.blocks -%}
                        {%- if block.type == 'scene' -%}
                            <a href="{{ block.settings.link }}" class="custom-search__scene-button">
                                {{ block.settings.title }}
                                <svg class="icon icon-arrow" aria-hidden="true" focusable="false" role="presentation" viewBox="0 0 8 12">
                                    <path d="M1 1l5 5-5 5" stroke="currentColor" stroke-width="2" fill="none" fill-rule="evenodd"></path>
                                </svg>
                            </a>
                        {%- endif -%}
                    {%- endfor -%}
                </div>
            </div>

            <div class="custom-search__bottom-row">
                <div class="custom-search__group">
                    <h3 class="custom-search__group-title">色を選ぶ</h3>
                    <div class="custom-search__color-swatches">
                        {%- for block in section.blocks -%}
                            {%- if block.type == 'color' -%}
                                {%- liquid
                                    assign color_tag = block.settings.color_name | handle
                                    assign collection_url = routes.all_products_collection_url
                                -%}
                                <a 
                                    href="{{ collection_url }}/{{ color_tag }}" 
                                    class="custom-search__swatch" 
                                    style="--swatch-color: {{ block.settings.color_value }};"
                                    aria-label="{{ block.settings.color_name }}"
                                ></a>
                            {%- endif -%}
                        {%- endfor -%}
                    </div>
                </div>

                <div class="custom-search__group">
                    <h3 class="custom-search__group-title">キーワード検索</h3>
                    <form action="{{ routes.search_url }}" method="get" class="custom-search__form">
                        <input type="search" name="q" placeholder="例：ラベンダー" class="custom-search__input">
                        <button type="submit" class="custom-search__submit">
                            <svg class="modal__toggle-open icon icon-search" aria-hidden="true" focusable="false" role="presentation">
                                <use href="#icon-search"></use>
                            </svg>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

{% schema %}
{
    "name": "【カスタム】商品検索",
    "class": "shopify-section--custom-search",
    "settings": [
        {
            "type": "header",
            "content": "セクションの余白"
        },
        {
            "type": "range",
            "id": "padding_top",
            "min": 0,
            "max": 200,
            "step": 10,
            "unit": "px",
            "label": "上の余白",
            "default": 50
        },
        {
            "type": "range",
            "id": "padding_bottom",
            "min": 0,
            "max": 200,
            "step": 10,
            "unit": "px",
            "label": "下の余白",
            "default": 50
        },
        {
            "type": "range",
            "id": "padding_top_mobile",
            "min": 0,
            "max": 100,
            "step": 5,
            "unit": "px",
            "label": "上の余白（スマホ）",
            "default": 30
        },
        {
            "type": "range",
            "id": "padding_bottom_mobile",
            "min": 0,
            "max": 100,
            "step": 5,
            "unit": "px",
            "label": "下の余白（スマホ）",
            "default": 30
        },
        {
            "type": "header",
            "content": "タイトルの設定"
        },
        {
            "type": "text",
            "id": "heading",
            "label": "見出し",
            "default": "タイトル"
        },
        {
            "type": "text",
            "id": "subheading",
            "label": "背景のテキスト",
            "default": "TITLE"
        },
        {
            "type": "color",
            "id": "title_subheading_color",
            "label": "背景テキストの色",
            "default": "#f4f5f5"
        },
        {
            "type": "select",
            "id": "title_text_alignment",
            "label": "タイトルの配置",
            "options": [
                { "value": "center", "label": "中央揃え" },
                { "value": "left", "label": "左揃え" }
            ],
            "default": "center"
        },
        {
            "type": "range",
            "id": "title_padding_top",
            "min": 0,
            "max": 100,
            "step": 5,
            "unit": "px",
            "label": "タイトルの上の余白",
            "default": 30
        },
        {
            "type": "range",
            "id": "title_padding_bottom",
            "min": 0,
            "max": 100,
            "step": 5,
            "unit": "px",
            "label": "タイトルの下の余白",
            "default": 30
        },
        {
            "type": "color",
            "id": "background_color",
            "label": "背景色",
            "default": "#f8f8f8"
        },
    ],
    "blocks": [
        {
            "type": "scene",
            "name": "シーン",
            "limit": 10,
            "settings": [
                {
                    "type": "text",
                    "id": "title",
                    "label": "タイトル",
                    "default": "シーン名"
                },
                {
                    "type": "url",
                    "id": "link",
                    "label": "リンク先"
                }
            ]
        },
        {
            "type": "color",
            "name": "色",
            "limit": 8,
            "settings": [
                {
                    "type": "color",
                    "id": "color_value",
                    "label": "色",
                    "default": "#ffffff"
                },
                {
                    "type": "text",
                    "id": "title",
                    "label": "タイトル",
                    "default": "色名"
                },
                {
                    "type": "text",
                    "id": "color_name",
                    "label": "色の名前（タグになります）",
                    "default": "ホワイト"
                }
            ]
        }
    ],
    "presets": [
        {
            "name": "【カスタム】商品検索"
        }
    ]
}
{% endschema %}